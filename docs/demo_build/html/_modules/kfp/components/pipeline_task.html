<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>kfp.components.pipeline_task &mdash; KFP SDK API Reference</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> Kubeflow Pipelines
            <img src="../../../_static/kubeflow.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../source/kfp.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../source/cli.html">kfp CLI</a></li>
<li class="toctree-l1"><a class="reference external" href="https://kubeflow.org/docs/pipelines/">Usage Docs (kubeflow.org)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/kubeflow/pipelines/">Source Code</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Kubeflow Pipelines</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      <li>kfp.components.pipeline_task</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for kfp.components.pipeline_task</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright 2021-2022 The Kubeflow Authors</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#      http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>
<span class="sd">&quot;&quot;&quot;Pipeline task class and operations.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">from</span> <span class="nn">kfp.components</span> <span class="kn">import</span> <span class="n">constants</span>
<span class="kn">from</span> <span class="nn">kfp.components</span> <span class="kn">import</span> <span class="n">pipeline_channel</span>
<span class="kn">from</span> <span class="nn">kfp.components</span> <span class="kn">import</span> <span class="n">placeholders</span>
<span class="kn">from</span> <span class="nn">kfp.components</span> <span class="kn">import</span> <span class="n">structures</span>
<span class="kn">from</span> <span class="nn">kfp.components</span> <span class="kn">import</span> <span class="n">utils</span>
<span class="kn">from</span> <span class="nn">kfp.components.types</span> <span class="kn">import</span> <span class="n">type_utils</span>


<span class="k">def</span> <span class="nf">create_pipeline_task</span><span class="p">(</span>
    <span class="n">component_spec</span><span class="p">:</span> <span class="n">structures</span><span class="o">.</span><span class="n">ComponentSpec</span><span class="p">,</span>
    <span class="n">args</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;PipelineTask&#39;</span><span class="p">:</span>  <span class="c1"># pytype: disable=name-error</span>
    <span class="k">return</span> <span class="n">PipelineTask</span><span class="p">(</span><span class="n">component_spec</span><span class="o">=</span><span class="n">component_spec</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">)</span>


<div class="viewcode-block" id="PipelineTask"><a class="viewcode-back" href="../../../source/dsl.html#kfp.dsl.PipelineTask">[docs]</a><span class="k">class</span> <span class="nc">PipelineTask</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Represents a pipeline task -- an instantiated component.</span>

<span class="sd">    Replaces `ContainerOp`. Holds operations available on a task object, such as</span>
<span class="sd">    `.after()`, `.set_memory_limit()`, `enable_caching()`, etc.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        name: The name of the task. Unique within its parent group.</span>
<span class="sd">        outputs:</span>
<span class="sd">        task_spec: The task spec of the task.</span>
<span class="sd">        component_spec: The component spec of the task.</span>
<span class="sd">        container_spec: The resolved container spec of the task. Only one of</span>
<span class="sd">            container_spec and importer_spec should be filled.</span>
<span class="sd">        importer_spec: The resolved importer spec of the task. Only one of</span>
<span class="sd">            container_spec and importer_spec should be filled.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Fallback behavior for compiling a component. This should be overriden by</span>
    <span class="c1"># pipeline `register_task_and_generate_id` if compiling a pipeline (more</span>
    <span class="c1"># than one component).</span>
    <span class="n">register_task_handler</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">task</span><span class="p">:</span> <span class="n">utils</span><span class="o">.</span><span class="n">maybe_rename_for_k8s</span><span class="p">(</span>
        <span class="n">task</span><span class="o">.</span><span class="n">component_spec</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">component_spec</span><span class="p">:</span> <span class="n">structures</span><span class="o">.</span><span class="n">ComponentSpec</span><span class="p">,</span>
        <span class="n">args</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initilizes a PipelineTask instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            component_spec: The component definition.</span>
<span class="sd">            args: The dictionary of component arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">args</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">input_name</span><span class="p">,</span> <span class="n">argument_value</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

            <span class="k">if</span> <span class="n">input_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">component_spec</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;Component &quot;</span><span class="si">{</span><span class="n">component_spec</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&quot; got an unexpected input:&#39;</span>
                    <span class="sa">f</span><span class="s1">&#39; </span><span class="si">{</span><span class="n">input_name</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>

            <span class="n">input_type</span> <span class="o">=</span> <span class="n">component_spec</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">input_name</span><span class="p">]</span><span class="o">.</span><span class="n">type</span>
            <span class="n">argument_type</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument_value</span><span class="p">,</span> <span class="n">pipeline_channel</span><span class="o">.</span><span class="n">PipelineChannel</span><span class="p">):</span>
                <span class="n">argument_type</span> <span class="o">=</span> <span class="n">argument_value</span><span class="o">.</span><span class="n">channel_type</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument_value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">argument_type</span> <span class="o">=</span> <span class="s1">&#39;String&#39;</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument_value</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                <span class="n">argument_type</span> <span class="o">=</span> <span class="s1">&#39;Boolean&#39;</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument_value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">argument_type</span> <span class="o">=</span> <span class="s1">&#39;Integer&#39;</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument_value</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
                <span class="n">argument_type</span> <span class="o">=</span> <span class="s1">&#39;Float&#39;</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument_value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">argument_type</span> <span class="o">=</span> <span class="s1">&#39;Dict&#39;</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument_value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">argument_type</span> <span class="o">=</span> <span class="s1">&#39;List&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Input argument supports only the following types: &#39;</span>
                    <span class="s1">&#39;str, int, float, bool, dict, and list. Got: &#39;</span>
                    <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">argument_value</span><span class="si">}</span><span class="s1">&quot; of type &quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">argument_value</span><span class="p">)</span><span class="si">}</span><span class="s1">&quot;.&#39;</span><span class="p">)</span>

            <span class="n">type_utils</span><span class="o">.</span><span class="n">verify_type_compatibility</span><span class="p">(</span>
                <span class="n">given_type</span><span class="o">=</span><span class="n">argument_type</span><span class="p">,</span>
                <span class="n">expected_type</span><span class="o">=</span><span class="n">input_type</span><span class="p">,</span>
                <span class="n">error_message_prefix</span><span class="o">=</span><span class="p">(</span>
                    <span class="s1">&#39;Incompatible argument passed to the input &#39;</span>
                    <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">input_name</span><span class="si">}</span><span class="s1">&quot; of component &quot;</span><span class="si">{</span><span class="n">component_spec</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&quot;: &#39;</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">component_spec</span> <span class="o">=</span> <span class="n">component_spec</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">task_spec</span> <span class="o">=</span> <span class="n">structures</span><span class="o">.</span><span class="n">TaskSpec</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">register_task_handler</span><span class="p">(),</span>
            <span class="n">inputs</span><span class="o">=</span><span class="p">{</span><span class="n">input_name</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">input_name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
            <span class="n">dependent_tasks</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">component_ref</span><span class="o">=</span><span class="n">component_spec</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">enable_caching</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">importer_spec</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">container_spec</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">component_spec</span><span class="o">.</span><span class="n">implementation</span><span class="o">.</span><span class="n">container</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">container_spec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_command_line_and_arguments</span><span class="p">(</span>
                <span class="n">component_spec</span><span class="o">=</span><span class="n">component_spec</span><span class="p">,</span>
                <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">component_spec</span><span class="o">.</span><span class="n">implementation</span><span class="o">.</span><span class="n">importer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">importer_spec</span> <span class="o">=</span> <span class="n">component_spec</span><span class="o">.</span><span class="n">implementation</span><span class="o">.</span><span class="n">importer</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">importer_spec</span><span class="o">.</span><span class="n">artifact_uri</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;uri&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_outputs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">output_name</span><span class="p">:</span> <span class="n">pipeline_channel</span><span class="o">.</span><span class="n">create_pipeline_channel</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">output_name</span><span class="p">,</span>
                <span class="n">channel_type</span><span class="o">=</span><span class="n">output_spec</span><span class="o">.</span><span class="n">type</span><span class="p">,</span>
                <span class="n">task_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">task_spec</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="p">)</span> <span class="k">for</span> <span class="n">output_name</span><span class="p">,</span> <span class="n">output_spec</span> <span class="ow">in</span> <span class="p">(</span>
                <span class="n">component_spec</span><span class="o">.</span><span class="n">outputs</span> <span class="ow">or</span> <span class="p">{})</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_inputs</span> <span class="o">=</span> <span class="n">args</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_channel_inputs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">value</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">pipeline_channel</span><span class="o">.</span><span class="n">PipelineChannel</span><span class="p">)</span>
        <span class="p">]</span> <span class="o">+</span> <span class="n">pipeline_channel</span><span class="o">.</span><span class="n">extract_pipeline_channels_from_any</span><span class="p">([</span>
            <span class="n">value</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">pipeline_channel</span><span class="o">.</span><span class="n">PipelineChannel</span><span class="p">)</span>
        <span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns the name of the task.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_spec</span><span class="o">.</span><span class="n">name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">inputs</span><span class="p">(</span>
        <span class="bp">self</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">type_utils</span><span class="o">.</span><span class="n">PARAMETER_TYPES</span><span class="p">,</span>
                    <span class="n">pipeline_channel</span><span class="o">.</span><span class="n">PipelineChannel</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Returns the list of actual inputs passed to the task.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inputs</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">channel_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">pipeline_channel</span><span class="o">.</span><span class="n">PipelineChannel</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Returns the list of all PipelineChannels passed to the task.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_inputs</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">output</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pipeline_channel</span><span class="o">.</span><span class="n">PipelineChannel</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns the single output object (a PipelineChannel) of the task.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_outputs</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_outputs</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pipeline_channel</span><span class="o">.</span><span class="n">PipelineChannel</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Returns the dictionary of outputs (PipelineChannels) of the task.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_outputs</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dependent_tasks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Returns the list of dependent task names.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_spec</span><span class="o">.</span><span class="n">dependent_tasks</span>

    <span class="k">def</span> <span class="nf">_resolve_command_line_and_arguments</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">component_spec</span><span class="p">:</span> <span class="n">structures</span><span class="o">.</span><span class="n">ComponentSpec</span><span class="p">,</span>
        <span class="n">args</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">structures</span><span class="o">.</span><span class="n">ContainerSpec</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Resolves the command line argument placeholders in a container spec.</span>

<span class="sd">        Args:</span>
<span class="sd">            component_spec: The component definition.</span>
<span class="sd">            args: The dictionary of component arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">argument_values</span> <span class="o">=</span> <span class="n">args</span>

        <span class="n">component_inputs</span> <span class="o">=</span> <span class="n">component_spec</span><span class="o">.</span><span class="n">inputs</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">inputs_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">input_name</span><span class="p">:</span> <span class="n">input_spec</span>
            <span class="k">for</span> <span class="n">input_name</span><span class="p">,</span> <span class="n">input_spec</span> <span class="ow">in</span> <span class="n">component_inputs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="n">component_outputs</span> <span class="o">=</span> <span class="n">component_spec</span><span class="o">.</span><span class="n">outputs</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">outputs_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">output_name</span><span class="p">:</span> <span class="n">output_spec</span>
            <span class="k">for</span> <span class="n">output_name</span><span class="p">,</span> <span class="n">output_spec</span> <span class="ow">in</span> <span class="n">component_outputs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="k">def</span> <span class="nf">check_input_type_and_convert_to_placeholder</span><span class="p">(</span>
                <span class="n">arg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="c1"># TODO: separate input type-checking logic from placeholder-conversion/.to_placeholder() logic</span>
            <span class="k">if</span> <span class="n">arg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)):</span>
                <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">placeholders</span><span class="o">.</span><span class="n">InputValuePlaceholder</span><span class="p">):</span>
                <span class="n">input_name</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">input_name</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">type_utils</span><span class="o">.</span><span class="n">is_parameter_type</span><span class="p">(</span>
                        <span class="n">inputs_dict</span><span class="p">[</span><span class="n">input_name</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s1">&#39;Input &quot;</span><span class="si">{</span><span class="n">input_name</span><span class="si">}</span><span class="s1">&quot; with type &#39;</span>
                        <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">inputs_dict</span><span class="p">[</span><span class="n">input_name</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s1">&quot; cannot be paired with &#39;</span>
                        <span class="s1">&#39;InputValuePlaceholder.&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">input_name</span> <span class="ow">in</span> <span class="n">args</span> <span class="ow">or</span> <span class="n">type_utils</span><span class="o">.</span><span class="n">is_task_final_status_type</span><span class="p">(</span>
                        <span class="n">inputs_dict</span><span class="p">[</span><span class="n">input_name</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">arg</span><span class="o">.</span><span class="n">to_placeholder_string</span><span class="p">()</span>

                <span class="n">input_spec</span> <span class="o">=</span> <span class="n">inputs_dict</span><span class="p">[</span><span class="n">input_name</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">input_spec</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s1">&#39;No value provided for input: </span><span class="si">{</span><span class="n">input_name</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span>

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">placeholders</span><span class="o">.</span><span class="n">InputUriPlaceholder</span><span class="p">):</span>
                <span class="n">input_name</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">input_name</span>
                <span class="k">if</span> <span class="n">type_utils</span><span class="o">.</span><span class="n">is_parameter_type</span><span class="p">(</span><span class="n">inputs_dict</span><span class="p">[</span><span class="n">input_name</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s1">&#39;Input &quot;</span><span class="si">{</span><span class="n">input_name</span><span class="si">}</span><span class="s1">&quot; with type &#39;</span>
                        <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">inputs_dict</span><span class="p">[</span><span class="n">input_name</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s1">&quot; cannot be paired with &#39;</span>
                        <span class="s1">&#39;InputUriPlaceholder.&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">input_name</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">arg</span><span class="o">.</span><span class="n">to_placeholder_string</span><span class="p">()</span>
                <span class="n">input_spec</span> <span class="o">=</span> <span class="n">inputs_dict</span><span class="p">[</span><span class="n">input_name</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">input_spec</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s1">&#39;No value provided for input: </span><span class="si">{</span><span class="n">input_name</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span>

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">placeholders</span><span class="o">.</span><span class="n">InputPathPlaceholder</span><span class="p">):</span>
                <span class="n">input_name</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">input_name</span>
                <span class="k">if</span> <span class="n">type_utils</span><span class="o">.</span><span class="n">is_parameter_type</span><span class="p">(</span><span class="n">inputs_dict</span><span class="p">[</span><span class="n">input_name</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s1">&#39;Input &quot;</span><span class="si">{</span><span class="n">input_name</span><span class="si">}</span><span class="s1">&quot; with type &#39;</span>
                        <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">inputs_dict</span><span class="p">[</span><span class="n">input_name</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s1">&quot; cannot be paired with &#39;</span>
                        <span class="s1">&#39;InputPathPlaceholder.&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">input_name</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">arg</span><span class="o">.</span><span class="n">to_placeholder_string</span><span class="p">()</span>
                <span class="n">input_spec</span> <span class="o">=</span> <span class="n">inputs_dict</span><span class="p">[</span><span class="n">input_name</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">input_spec</span><span class="o">.</span><span class="n">_optional</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s1">&#39;No value provided for input: </span><span class="si">{</span><span class="n">input_name</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">placeholders</span><span class="o">.</span><span class="n">OutputUriPlaceholder</span><span class="p">):</span>
                <span class="n">output_name</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">output_name</span>
                <span class="k">if</span> <span class="n">type_utils</span><span class="o">.</span><span class="n">is_parameter_type</span><span class="p">(</span><span class="n">outputs_dict</span><span class="p">[</span><span class="n">output_name</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s1">&#39;Onput &quot;</span><span class="si">{</span><span class="n">output_name</span><span class="si">}</span><span class="s1">&quot; with type &#39;</span>
                        <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">outputs_dict</span><span class="p">[</span><span class="n">output_name</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s1">&quot; cannot be paired with &#39;</span>
                        <span class="s1">&#39;OutputUriPlaceholder.&#39;</span><span class="p">)</span>

                <span class="k">return</span> <span class="n">arg</span><span class="o">.</span><span class="n">to_placeholder_string</span><span class="p">()</span>

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="p">(</span><span class="n">placeholders</span><span class="o">.</span><span class="n">OutputPathPlaceholder</span><span class="p">,</span>
                                  <span class="n">placeholders</span><span class="o">.</span><span class="n">OutputParameterPlaceholder</span><span class="p">)):</span>
                <span class="n">output_name</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">output_name</span>
                <span class="k">return</span> <span class="n">placeholders</span><span class="o">.</span><span class="n">OutputParameterPlaceholder</span><span class="p">(</span>
                    <span class="n">arg</span><span class="o">.</span><span class="n">output_name</span><span class="p">)</span><span class="o">.</span><span class="n">to_placeholder_string</span><span class="p">(</span>
                    <span class="p">)</span> <span class="k">if</span> <span class="n">type_utils</span><span class="o">.</span><span class="n">is_parameter_type</span><span class="p">(</span>
                        <span class="n">outputs_dict</span><span class="p">[</span><span class="n">output_name</span><span class="p">]</span><span class="o">.</span><span class="n">type</span>
                    <span class="p">)</span> <span class="k">else</span> <span class="n">placeholders</span><span class="o">.</span><span class="n">OutputPathPlaceholder</span><span class="p">(</span>
                        <span class="n">arg</span><span class="o">.</span><span class="n">output_name</span><span class="p">)</span><span class="o">.</span><span class="n">to_placeholder_string</span><span class="p">()</span>

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">placeholders</span><span class="o">.</span><span class="n">Placeholder</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">arg</span><span class="o">.</span><span class="n">to_placeholder_string</span><span class="p">()</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unrecognized argument type: </span><span class="si">{</span><span class="n">arg</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">expand_argument_list</span><span class="p">(</span><span class="n">argument_list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
            <span class="k">if</span> <span class="n">argument_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>

            <span class="n">expanded_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">argument_list</span><span class="p">:</span>
                <span class="n">expanded_part</span> <span class="o">=</span> <span class="n">check_input_type_and_convert_to_placeholder</span><span class="p">(</span>
                    <span class="n">part</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">expanded_part</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expanded_part</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                        <span class="n">expanded_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">expanded_part</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">expanded_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">expanded_part</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">expanded_list</span>

        <span class="n">container_spec</span> <span class="o">=</span> <span class="n">component_spec</span><span class="o">.</span><span class="n">implementation</span><span class="o">.</span><span class="n">container</span>

        <span class="n">resolved_container_spec</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">container_spec</span><span class="p">)</span>
        <span class="n">resolved_container_spec</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">expand_argument_list</span><span class="p">(</span>
            <span class="n">container_spec</span><span class="o">.</span><span class="n">command</span><span class="p">)</span>
        <span class="n">resolved_container_spec</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">expand_argument_list</span><span class="p">(</span><span class="n">container_spec</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">resolved_container_spec</span>

<div class="viewcode-block" id="PipelineTask.set_caching_options"><a class="viewcode-back" href="../../../source/dsl.html#kfp.dsl.PipelineTask.set_caching_options">[docs]</a>    <span class="k">def</span> <span class="nf">set_caching_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enable_caching</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;PipelineTask&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Sets caching options for the Pipeline task.</span>

<span class="sd">        Args:</span>
<span class="sd">            enable_caching: Whether or not to enable caching for this task.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self return to allow chained setting calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task_spec</span><span class="o">.</span><span class="n">enable_caching</span> <span class="o">=</span> <span class="n">enable_caching</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="PipelineTask.set_cpu_limit"><a class="viewcode-back" href="../../../source/dsl.html#kfp.dsl.PipelineTask.set_cpu_limit">[docs]</a>    <span class="k">def</span> <span class="nf">set_cpu_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cpu</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;PipelineTask&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set cpu limit (maximum) for this operator.</span>

<span class="sd">        Args:</span>
<span class="sd">            cpu(str): A string which can be a</span>
<span class="sd">                number or a number followed by &quot;m&quot;, whichmeans 1/1000.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self return to allow chained setting calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;([0-9]*[.])?[0-9]+m?$&#39;</span><span class="p">,</span> <span class="n">cpu</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Invalid cpu string. Should be float or integer, or integer&#39;</span>
                <span class="s1">&#39; followed by &quot;m&quot;.&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cpu</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">):</span>
            <span class="n">cpu</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">cpu</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">1000</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cpu</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">cpu</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">container_spec</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;There is no container specified in implementation&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">container_spec</span><span class="o">.</span><span class="n">resources</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">container_spec</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">cpu_limit</span> <span class="o">=</span> <span class="n">cpu</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">container_spec</span><span class="o">.</span><span class="n">resources</span> <span class="o">=</span> <span class="n">structures</span><span class="o">.</span><span class="n">ResourceSpec</span><span class="p">(</span>
                <span class="n">cpu_limit</span><span class="o">=</span><span class="n">cpu</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="PipelineTask.set_gpu_limit"><a class="viewcode-back" href="../../../source/dsl.html#kfp.dsl.PipelineTask.set_gpu_limit">[docs]</a>    <span class="k">def</span> <span class="nf">set_gpu_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gpu</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;PipelineTask&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set gpu limit (maximum) for this operator.</span>

<span class="sd">        Args:</span>
<span class="sd">            gpu(str): Positive number required for number of GPUs.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self return to allow chained setting calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[1-9]\d*$&#39;</span><span class="p">,</span> <span class="n">gpu</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;GPU must be positive integer.&#39;</span><span class="p">)</span>

        <span class="n">gpu</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">gpu</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">container_spec</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;There is no container specified in implementation&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">container_spec</span><span class="o">.</span><span class="n">resources</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">container_spec</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">accelerator_count</span> <span class="o">=</span> <span class="n">gpu</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">container_spec</span><span class="o">.</span><span class="n">resources</span> <span class="o">=</span> <span class="n">structures</span><span class="o">.</span><span class="n">ResourceSpec</span><span class="p">(</span>
                <span class="n">accelerator_count</span><span class="o">=</span><span class="n">gpu</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="PipelineTask.set_memory_limit"><a class="viewcode-back" href="../../../source/dsl.html#kfp.dsl.PipelineTask.set_memory_limit">[docs]</a>    <span class="k">def</span> <span class="nf">set_memory_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;PipelineTask&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set memory limit (maximum) for this operator.</span>

<span class="sd">        Args:</span>
<span class="sd">            memory(str): a string which can be a number or a number followed by</span>
<span class="sd">                one of &quot;E&quot;, &quot;Ei&quot;, &quot;P&quot;, &quot;Pi&quot;, &quot;T&quot;, &quot;Ti&quot;, &quot;G&quot;, &quot;Gi&quot;, &quot;M&quot;, &quot;Mi&quot;,</span>
<span class="sd">                &quot;K&quot;, &quot;Ki&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self return to allow chained setting calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^[0-9]+(E|Ei|P|Pi|T|Ti|G|Gi|M|Mi|K|Ki){0,1}$&#39;</span><span class="p">,</span>
                    <span class="n">memory</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Invalid memory string. Should be a number or a number &#39;</span>
                <span class="s1">&#39;followed by one of &quot;E&quot;, &quot;Ei&quot;, &quot;P&quot;, &quot;Pi&quot;, &quot;T&quot;, &quot;Ti&quot;, &quot;G&quot;, &#39;</span>
                <span class="s1">&#39;&quot;Gi&quot;, &quot;M&quot;, &quot;Mi&quot;, &quot;K&quot;, &quot;Ki&quot;.&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">memory</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">):</span>
            <span class="n">memory</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">memory</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">_E</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">_G</span>
        <span class="k">elif</span> <span class="n">memory</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;Ei&#39;</span><span class="p">):</span>
            <span class="n">memory</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">memory</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">_EI</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">_G</span>
        <span class="k">elif</span> <span class="n">memory</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">):</span>
            <span class="n">memory</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">memory</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">_P</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">_G</span>
        <span class="k">elif</span> <span class="n">memory</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;Pi&#39;</span><span class="p">):</span>
            <span class="n">memory</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">memory</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">_PI</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">_G</span>
        <span class="k">elif</span> <span class="n">memory</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">):</span>
            <span class="n">memory</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">memory</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">_T</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">_G</span>
        <span class="k">elif</span> <span class="n">memory</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;Ti&#39;</span><span class="p">):</span>
            <span class="n">memory</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">memory</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">_TI</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">_G</span>
        <span class="k">elif</span> <span class="n">memory</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">):</span>
            <span class="n">memory</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">memory</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">memory</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;Gi&#39;</span><span class="p">):</span>
            <span class="n">memory</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">memory</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">_GI</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">_G</span>
        <span class="k">elif</span> <span class="n">memory</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">):</span>
            <span class="n">memory</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">memory</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">_M</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">_G</span>
        <span class="k">elif</span> <span class="n">memory</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;Mi&#39;</span><span class="p">):</span>
            <span class="n">memory</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">memory</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">_MI</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">_G</span>
        <span class="k">elif</span> <span class="n">memory</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">):</span>
            <span class="n">memory</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">memory</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">_K</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">_G</span>
        <span class="k">elif</span> <span class="n">memory</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;Ki&#39;</span><span class="p">):</span>
            <span class="n">memory</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">memory</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">_KI</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">_G</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># By default interpret as a plain integer, in the unit of Bytes.</span>
            <span class="n">memory</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">memory</span><span class="p">)</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">_G</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">container_spec</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;There is no container specified in implementation&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">container_spec</span><span class="o">.</span><span class="n">resources</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">container_spec</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">memory_limit</span> <span class="o">=</span> <span class="n">memory</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">container_spec</span><span class="o">.</span><span class="n">resources</span> <span class="o">=</span> <span class="n">structures</span><span class="o">.</span><span class="n">ResourceSpec</span><span class="p">(</span>
                <span class="n">memory_limit</span><span class="o">=</span><span class="n">memory</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="PipelineTask.set_retry"><a class="viewcode-back" href="../../../source/dsl.html#kfp.dsl.PipelineTask.set_retry">[docs]</a>    <span class="k">def</span> <span class="nf">set_retry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                  <span class="n">num_retries</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                  <span class="n">backoff_duration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">backoff_factor</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">backoff_max_duration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;PipelineTask&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Sets task retry parameters.</span>

<span class="sd">        Args:</span>
<span class="sd">            num_retries (int): Number of times to retry on failure.</span>
<span class="sd">            backoff_duration (Optional[int]): The the number of seconds to wait before triggering a retry. Defaults to &#39;0s&#39; (immediate retry).</span>
<span class="sd">            backoff_factor (Optional[float]): The exponential backoff factor applied to backoff_duration. For example, if backoff_duration=&quot;60&quot; (60 seconds) and backoff_factor=2, the first retry will happen after 60 seconds, then after 120, 240, and so on. Defaults to 2.0.</span>
<span class="sd">            backoff_max_duration (Optional[int]): The maximum duration during which the task will be retried. Maximum duration is 1 hour (3600s). Defaults to &#39;3600s&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self return to allow chained setting calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task_spec</span><span class="o">.</span><span class="n">retry_policy</span> <span class="o">=</span> <span class="n">structures</span><span class="o">.</span><span class="n">RetryPolicy</span><span class="p">(</span>
            <span class="n">max_retry_count</span><span class="o">=</span><span class="n">num_retries</span><span class="p">,</span>
            <span class="n">backoff_duration</span><span class="o">=</span><span class="n">backoff_duration</span><span class="p">,</span>
            <span class="n">backoff_factor</span><span class="o">=</span><span class="n">backoff_factor</span><span class="p">,</span>
            <span class="n">backoff_max_duration</span><span class="o">=</span><span class="n">backoff_max_duration</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="PipelineTask.add_node_selector_constraint"><a class="viewcode-back" href="../../../source/dsl.html#kfp.dsl.PipelineTask.add_node_selector_constraint">[docs]</a>    <span class="k">def</span> <span class="nf">add_node_selector_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">accelerator</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;PipelineTask&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Sets accelerator type requirement for this task.</span>

<span class="sd">        Args:</span>
<span class="sd">            value(str): The name of the accelerator. Available values include</span>
<span class="sd">                &#39;NVIDIA_TESLA_K80&#39;, &#39;TPU_V3&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self return to allow chained setting calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">container_spec</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;There is no container specified in implementation&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">container_spec</span><span class="o">.</span><span class="n">resources</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">container_spec</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">accelerator_type</span> <span class="o">=</span> <span class="n">accelerator</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">container_spec</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">accelerator_count</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">container_spec</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">accelerator_count</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">container_spec</span><span class="o">.</span><span class="n">resources</span> <span class="o">=</span> <span class="n">structures</span><span class="o">.</span><span class="n">ResourceSpec</span><span class="p">(</span>
                <span class="n">accelerator_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">accelerator_type</span><span class="o">=</span><span class="n">accelerator</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="PipelineTask.set_display_name"><a class="viewcode-back" href="../../../source/dsl.html#kfp.dsl.PipelineTask.set_display_name">[docs]</a>    <span class="k">def</span> <span class="nf">set_display_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;PipelineTask&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set display name for the pipelineTask.</span>

<span class="sd">        Args:</span>
<span class="sd">            name(str): display name for the task.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self return to allow chained setting calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task_spec</span><span class="o">.</span><span class="n">display_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="PipelineTask.set_env_variable"><a class="viewcode-back" href="../../../source/dsl.html#kfp.dsl.PipelineTask.set_env_variable">[docs]</a>    <span class="k">def</span> <span class="nf">set_env_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;PipelineTask&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set environment variable for the pipelineTask.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: The name of the environment variable.</span>
<span class="sd">            value: The value of the environment variable.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self return to allow chained setting calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">container_spec</span><span class="o">.</span><span class="n">env</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">container_spec</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">container_spec</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">value</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="PipelineTask.after"><a class="viewcode-back" href="../../../source/dsl.html#kfp.dsl.PipelineTask.after">[docs]</a>    <span class="k">def</span> <span class="nf">after</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">tasks</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;PipelineTask&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Specify explicit dependency on other tasks.</span>

<span class="sd">        Args:</span>
<span class="sd">            name(tasks): dependent tasks.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self return to allow chained setting calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">tasks</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">task_spec</span><span class="o">.</span><span class="n">dependent_tasks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">task</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, The Kubeflow Authors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>