apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# namespace is required to change generated configmap to correct namespace
namespace: kubeflow
patchesStrategicMerge:
- proxy-agent-patch.yaml
- workflow-controller-configmap-patch.yaml

# Used by Kustomize.
configMapGenerator:
- behavior: merge
  envs:
  - params.env
  name: pipeline-install-config

# Actual image overrides will be added in test scripts.
images:
- name: gcr.io/ml-pipeline/api-server
  newName: gcr.io/ml-pipeline-test/654e37bc3139822994ec837d441979897c910cfd/api-server
  newTag: latest
- name: gcr.io/ml-pipeline/cache-deployer
  newName: gcr.io/ml-pipeline-test/654e37bc3139822994ec837d441979897c910cfd/cache-deployer
  newTag: latest
- name: gcr.io/ml-pipeline/cache-server
  newName: gcr.io/ml-pipeline-test/654e37bc3139822994ec837d441979897c910cfd/cache-server
  newTag: latest
- name: gcr.io/ml-pipeline/frontend
  newName: gcr.io/ml-pipeline-test/654e37bc3139822994ec837d441979897c910cfd/frontend
  newTag: latest
- name: gcr.io/ml-pipeline/inverse-proxy-agent
  newName: gcr.io/ml-pipeline-test/654e37bc3139822994ec837d441979897c910cfd/inverse-proxy-agent
  newTag: latest
- name: gcr.io/ml-pipeline/metadata-envoy
  newName: gcr.io/ml-pipeline-test/654e37bc3139822994ec837d441979897c910cfd/metadata-envoy
  newTag: latest
- name: gcr.io/ml-pipeline/metadata-writer
  newName: gcr.io/ml-pipeline-test/654e37bc3139822994ec837d441979897c910cfd/metadata-writer
  newTag: latest
- name: gcr.io/ml-pipeline/persistenceagent
  newName: gcr.io/ml-pipeline-test/654e37bc3139822994ec837d441979897c910cfd/persistenceagent
  newTag: latest
- name: gcr.io/ml-pipeline/scheduledworkflow
  newName: gcr.io/ml-pipeline-test/654e37bc3139822994ec837d441979897c910cfd/scheduledworkflow
  newTag: latest
- name: gcr.io/ml-pipeline/viewer-crd-controller
  newName: gcr.io/ml-pipeline-test/654e37bc3139822994ec837d441979897c910cfd/viewer-crd-controller
  newTag: latest
- name: gcr.io/ml-pipeline/visualization-server
  newName: gcr.io/ml-pipeline-test/654e37bc3139822994ec837d441979897c910cfd/visualization-server
  newTag: latest
resources:
- ../../../manifests/kustomize/env/dev
